"""
StartupGraveyard: Where billion-dollar ideas go to die
A comprehensive database tracking the lifecycle of overfunded startup ideas
"""

scalar DateTime
scalar UUID
scalar Decimal

enum DeathCause {
  RAN_OUT_OF_MONEY
  PRODUCT_MARKET_FIT_404
  FOUNDER_DRAMA
  ACQUIRED_BY_FACEBOOK
  PIVOT_TO_CRYPTO
  PIVOT_FROM_CRYPTO
  AI_HYPE_EXPIRED
  ACTUAL_SUCCESS  # Rare but happens
}

enum FundingStage {
  FRIENDS_AND_FOOLS
  SEED_OF_DOUBT
  SERIES_ANXIETY
  SERIES_BURNOUT
  SERIES_CHAOS
  SERIES_DESPERATION
  IPO_OR_RIP
}

enum BuzzwordCategory {
  BLOCKCHAIN
  AI_ML
  UBER_FOR_X
  NETFLIX_FOR_Y
  TINDER_BUT_FOR_Z
  WEB3
  METAVERSE
  QUANTUM
  SUSTAINABLE
  DISRUPTIVE
}

"""
The visionaries who convinced VCs to part with their money
"""
type Founder @table @rls(enable: true) {
  id: ID! @pk @default(value: "gen_random_uuid()")
  name: String!
  twitter_handle: String @unique # For the inevitable "building in public" phase
  linkedin_title: String! # "Serial Entrepreneur | Thought Leader | Disruptor"
  previous_failures: Int! @default(value: 0)
  total_raised_lifetime: Decimal! @default(value: "0.00")
  is_currently_pivoting: Boolean! @default(value: false)
  created_at: DateTime! @default(value: "now()")
  
  # Relationships
  startups: [Startup!]! @hasMany(field: "founder_id")
  blog_posts: [BlogPost!]! @hasMany(field: "author_id")
}

"""
The actual companies (may they rest in peace)
"""
type Startup @table @tenant(by: "investor_id") @softDelete {
  id: ID! @pk @default(value: "gen_random_uuid()")
  name: String! @unique
  tagline: String! # "Uber for cats" or "LinkedIn for dogs"
  
  # The dream vs reality
  original_vision: String!
  actual_product: String # Often null
  
  # Timeline of doom
  founded_date: DateTime!
  death_date: DateTime
  lifetime_days: Int @computed(expr: "EXTRACT(DAY FROM (COALESCE(death_date, NOW()) - founded_date))", stored: true)
  
  # Money burned
  total_funding: Decimal! @default(value: "0.00") @check(expr: "total_funding >= 0")
  burn_rate_monthly: Decimal
  runway_days: Int @computed(expr: "CASE WHEN burn_rate_monthly > 0 THEN (total_funding / (burn_rate_monthly / 30))::int ELSE NULL END", stored: false)
  
  # The end
  cause_of_death: DeathCause
  final_message: String # The farewell Medium post
  
  # Metadata
  funding_stage: FundingStage! @default(value: "'FRIENDS_AND_FOOLS'")
  employee_count_peak: Int! @default(value: 1)
  press_releases_count: Int! @default(value: 0)
  pivot_count: Int! @default(value: 0) @check(expr: "pivot_count >= 0")
  
  # Relationships
  founder_id: ID! @fk(ref: "Founder.id", onDelete: "RESTRICT")
  investor_id: ID! @fk(ref: "Investor.id", onDelete: "RESTRICT")
  
  founder: Founder! @belongsTo(field: "founder_id")
  investor: Investor! @belongsTo(field: "investor_id")
  buzzwords: [StartupBuzzword!]! @hasMany(field: "startup_id")
  pivots: [Pivot!]! @hasMany(field: "startup_id")
  
  created_at: DateTime! @default(value: "now()")
  updated_at: DateTime! @default(value: "now()")
  deleted_at: DateTime # Soft delete timestamp
}

"""
The money behind the madness
"""
type Investor @table @rls(enable: true) {
  id: ID! @pk @default(value: "gen_random_uuid()")
  name: String!
  fund_size: Decimal!
  portfolio_failure_rate: Float! @default(value: 0.95) # Industry standard
  favorite_buzzword: BuzzwordCategory!
  
  # Their track record
  total_investments: Int! @default(value: 0)
  successful_exits: Int! @default(value: 0)
  
  startups: [Startup!]! @hasMany(field: "investor_id")
  
  created_at: DateTime! @default(value: "now()")
}

"""
Many-to-many relationship for startup buzzwords
"""
type StartupBuzzword @table @index(fields: ["startup_id", "buzzword"]) {
  id: ID! @pk @default(value: "gen_random_uuid()")
  startup_id: ID! @fk(ref: "Startup.id", onDelete: "CASCADE")
  buzzword: BuzzwordCategory!
  times_mentioned_in_pitch: Int! @default(value: 1)
  
  startup: Startup! @belongsTo(field: "startup_id")
  
  created_at: DateTime! @default(value: "now()")
  
  # Unique constraint on startup + buzzword combo
  @@unique([startup_id, buzzword])
}

"""
Track each desperate pivot attempt
"""
type Pivot @table @audit {
  id: ID! @pk @default(value: "gen_random_uuid()")
  startup_id: ID! @fk(ref: "Startup.id", onDelete: "CASCADE")
  
  from_idea: String!
  to_idea: String!
  pivot_date: DateTime!
  press_release_title: String # "We're not pivoting, we're evolving"
  
  # Did it work? (Spoiler: probably not)
  success_metrics_promised: String
  success_metrics_achieved: String
  
  startup: Startup! @belongsTo(field: "startup_id")
  
  created_at: DateTime! @default(value: "now()")
  updated_at: DateTime! @default(value: "now()")
}

"""
The thought leadership nobody asked for
"""
type BlogPost @table @rls(enable: true) {
  id: ID! @pk @default(value: "gen_random_uuid()")
  author_id: ID! @fk(ref: "Founder.id", onDelete: "CASCADE")
  
  title: String! # "10 Things I Learned From My Startup Failure"
  content: String!
  
  # Engagement metrics
  medium_claps: Int! @default(value: 0)
  linkedin_reactions: Int! @default(value: 0)
  hn_points: Int! @default(value: 0)
  
  # Meta
  contains_phrase_journey: Boolean! @default(value: true)
  contains_phrase_learnings: Boolean! @default(value: true)
  contains_phrase_grateful: Boolean! @default(value: true)
  
  author: Founder! @belongsTo(field: "author_id")
  
  published_at: DateTime! @default(value: "now()")
}

"""
Statistics view for the graveyard
"""
type StartupStats @view {
  total_money_burned: Decimal!
  average_lifetime_days: Float!
  most_common_death_cause: DeathCause!
  total_pivots: Int!
  total_blog_posts: Int!
}