CREATE TABLE IF NOT EXISTS "tenants" (
  "id" uuid NOT NULL,
  "name" text NOT NULL,
  "plan" text NOT NULL DEFAULT 'free',
  PRIMARY KEY ("id"),
  UNIQUE ("name")
);
COMMENT ON TABLE "tenants" IS 'uid: tbl:Tenant';
COMMENT ON COLUMN "tenants"."id" IS 'uid: col:Tenant.id';
COMMENT ON COLUMN "tenants"."name" IS 'uid: col:Tenant.name';
COMMENT ON COLUMN "tenants"."plan" IS 'uid: col:Tenant.plan';
CREATE TABLE IF NOT EXISTS "users" (
  "id" uuid NOT NULL,
  "email" text NOT NULL,
  "tenant_id" uuid NOT NULL,
  "role" text NOT NULL DEFAULT 'member',
  PRIMARY KEY ("id"),
  UNIQUE ("email"),
  FOREIGN KEY ("tenant_id") REFERENCES "tenants"("id") ON DELETE NO ACTION
);
COMMENT ON TABLE "users" IS 'uid: tbl:User';
COMMENT ON COLUMN "users"."id" IS 'uid: col:User.id';
COMMENT ON COLUMN "users"."email" IS 'uid: col:User.email';
COMMENT ON COLUMN "users"."tenant_id" IS 'uid: col:User.tenantId';
COMMENT ON COLUMN "users"."role" IS 'uid: col:User.role';
CREATE INDEX IF NOT EXISTS "users_tenant_id_idx" ON "users" ("tenant_id");
COMMENT ON INDEX "users_tenant_id_idx" IS 'uid: idx_users_tenant_id';
CREATE TABLE IF NOT EXISTS "projects" (
  "id" uuid NOT NULL,
  "name" text NOT NULL,
  "tenant_id" uuid NOT NULL,
  "owner_id" uuid NOT NULL,
  "settings" jsonb DEFAULT {},
  PRIMARY KEY ("id"),
  FOREIGN KEY ("tenant_id") REFERENCES "tenants"("id") ON DELETE NO ACTION,
  FOREIGN KEY ("owner_id") REFERENCES "users"("id") ON DELETE NO ACTION
);
COMMENT ON TABLE "projects" IS 'uid: tbl:Project';
COMMENT ON COLUMN "projects"."id" IS 'uid: col:Project.id';
COMMENT ON COLUMN "projects"."name" IS 'uid: col:Project.name';
COMMENT ON COLUMN "projects"."tenant_id" IS 'uid: col:Project.tenantId';
COMMENT ON COLUMN "projects"."owner_id" IS 'uid: col:Project.ownerId';
COMMENT ON COLUMN "projects"."settings" IS 'uid: col:Project.settings';
CREATE INDEX IF NOT EXISTS "projects_tenant_id_idx" ON "projects" ("tenant_id");
COMMENT ON INDEX "projects_tenant_id_idx" IS 'uid: idx_projects_tenant_id';
CREATE INDEX IF NOT EXISTS "projects_owner_id_idx" ON "projects" ("owner_id");
COMMENT ON INDEX "projects_owner_id_idx" IS 'uid: idx_projects_owner_id';
