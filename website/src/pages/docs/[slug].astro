---
import DocsLayout from '../../layouts/DocsLayout.astro';
import MarkdownRenderer from '../../components/MarkdownRenderer.astro';
import { getDocContent, getNavItems, listDocSlugs } from '../../utils/docs';

export function getStaticPaths() {
  return listDocSlugs()
    .filter((slug) => slug !== 'index')
    .map((slug) => ({ params: { slug } }));
}

const { slug } = Astro.params;

let markdown: string;
try {
  markdown = getDocContent(slug as string);
} catch (error) {
  return new Response('Not found', { status: 404 });
}

const navItems = getNavItems();
---
<DocsLayout navItems={navItems} currentSlug={slug as string}>
  <MarkdownRenderer content={markdown} />
</DocsLayout>
